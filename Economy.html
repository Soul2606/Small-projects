<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<h1>Economy</h1>
	<button id="button" onclick="advance_time()">Next</button>

	<div class="flex">
		<h3>Population</h3>
		<h3>10^</h3>
		<h3 id="population"></h3>
	</div>

	<div class="flex" style="align-items: flex-start;">

		<div class="resources-list">	
			<h3>Commodities</h3>
			<p class="resources-list-name">organics</p>
			<p class="resources-list-amount" id="organics">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">cultivable soil</p>
			<p class="resources-list-amount" id="cultivable-soil">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">water</p>
			<p class="resources-list-amount" id="water">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">food</p>
			<p class="resources-list-amount" id="food">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">basic commodities</p>
			<p class="resources-list-amount" id="basic-commodities">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">luxury goods</p>
			<p class="resources-list-amount" id="luxury-goods">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">raw minerals</p>
			<p class="resources-list-amount" id="raw-minerals">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">metal ore</p>
			<p class="resources-list-amount" id="metal-ore">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">refined metal</p>
			<p class="resources-list-amount" id="refined-metal">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">heavy armaments</p>
			<p class="resources-list-amount" id="heavy-armaments">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="resources-list-name">recreational drugs</p>
			<p class="resources-list-amount" id="recreational-drugs">0</p>
		</div>
	
		<div class="industry-list">
			<h3>Industries</h3>
			<p class="industry-list-name">water industry</p>
			<p class="industry-list-size" id="water-industry">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="industry-list-name">farming</p>
			<p class="industry-list-size" id="farming">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="industry-list-name">light industry</p>
			<p class="industry-list-size" id="light-industry">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="industry-list-name">mining</p>
			<p class="industry-list-size" id="mining">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
			<p class="industry-list-name">refining</p>
			<p class="industry-list-size" id="refining">0</p>
			<div style="grid-column: 1/3; border: solid white 2px;"></div>
		</div>
	</div>
	
</body>
<style>



.resources-list{
	width: min-content;
	display: grid;
	grid-template-columns: auto auto;
	gap: 10px 25px;
	margin-right: 50px;
}

.resources-list-name{
	grid-column-start: 1;
	grid-column-end: 2;
	text-wrap: nowrap;
	margin: 0;
}

.resources-list-amount{
	grid-column-start: 2;
	grid-column-end: 3;
	text-wrap: nowrap;
	margin: 0;
}




.industry-list{
	width: min-content;
	display: grid;
	grid-template-columns: auto auto;
	gap: 10px 25px;
	margin-right: 50px;
}

.industry-list-name{
	grid-column-start: 1;
	grid-column-end: 2;
	text-wrap: nowrap;
	margin: 0;
}

.industry-list-size{
	grid-column-start: 2;
	grid-column-end: 3;
	text-wrap: nowrap;
	margin: 0;
}




</style>
<script>



class Economy {
	constructor(population, organics, cultivable_soil, water, food, basic_commodities, luxury_goods, raw_minerals, metal_ore, refined_metal, heavy_armaments, recreational_drugs, base_productivity){
		this.population =			population
		this.commodities = new Commodities(organics, cultivable_soil, water, food, basic_commodities, luxury_goods, raw_minerals, metal_ore, refined_metal, heavy_armaments, recreational_drugs)
		//Industry
		this.water_industry =		new Industry(base_productivity,	20,	0,	new Commodities())
		this.farming =				new Industry(base_productivity,	2,	0,	new Commodities(0,1))
		this.light_industry =		new Industry(base_productivity,	8,	0,	new Commodities(1))
		this.mining =				new Industry(base_productivity,	2,	0,	new Commodities("recreational_drugs,5"))
		this.refining =				new Industry(base_productivity,	8,	0,	new Commodities("raw_mineral,1,metal_ore,2"))/*raw_mineral, metal_ore*/
	}

	demand() {
		let all_requirements = new Commodities(0,0,this.population, this.population)
		all_requirements.add(this.water_industry.	requirements.multiply(this.water_industry.	size))
		all_requirements.add(this.farming.			requirements.multiply(this.farming.			size))
		all_requirements.add(this.light_industry.	requirements.multiply(this.light_industry.	size))
		all_requirements.add(this.mining.			requirements.multiply(this.mining.			size))
		all_requirements.add(this.refining.			requirements.multiply(this.refining.		size))
		return all_requirements
	}
}




class Commodities {
	constructor(organics = 0, cultivable_soil = 0, water = 0, food = 0, basic_commodities = 0, luxury_goods = 0, raw_minerals = 0, metal_ore = 0, refined_metal = 0, heavy_armaments = 0, recreational_drugs = 0){
		if(organics === undefined || !isNaN(organics)){
			this.organics =				organics,
			this.cultivable_soil =		cultivable_soil
			this.water =				water
			this.food =					food
			this.basic_commodities =	basic_commodities
			this.luxury_goods =			luxury_goods
			this.raw_minerals =			raw_minerals
			this.metal_ore =			metal_ore
			this.refined_metal =		refined_metal
			this.heavy_armaments =		heavy_armaments
			this.recreational_drugs =	recreational_drugs
		}else if(typeof organics === "string"){
			//This code is to make it easier to construct a new object with the values you want so you don't have to write 0,0,0,0,0,1
			this.organics =				0
			this.cultivable_soil =		0
			this.water =				0
			this.food =					0
			this.basic_commodities =	0
			this.luxury_goods =			0
			this.raw_minerals =			0
			this.metal_ore =			0
			this.refined_metal =		0
			this.heavy_armaments =		0
			this.recreational_drugs =	0

			let parsed_code = organics.split(",")
			for (let i = 0; i < parsed_code.length; i+=2) {
				const key = parsed_code[i]
				const value = Number(parsed_code[i + 1])
				this[key] = value
			}
		}
	}

	toString() {
		return ""										+
		"organics"			+ this.organics				+
		"cultivable_soil"	+ this.cultivable_soil		+
		"water"				+ this.water				+
		"food"				+ this.food					+
		"basic_commodities"	+ this.basic_commodities	+
		"luxury_goods"		+ this.luxury_goods			+
		"raw_minerals"		+ this.raw_minerals			+
		"metal_ore"			+ this.metal_ore			+
		"refined_metal"		+ this.refined_metal		+
		"heavy_armaments"	+ this.heavy_armaments		+
		"recreational_drugs"+ this.recreational_drugs
	}

	add(value) {
		if(value instanceof Commodities){
			this.organics += 			value.organics
			this.cultivable_soil += 	value.cultivable_soil
			this.water += 				value.water
			this.food += 				value.food
			this.basic_commodities += 	value.basic_commodities
			this.luxury_goods += 		value.luxury_goods
			this.raw_minerals += 		value.raw_minerals
			this.metal_ore += 			value.metal_ore
			this.refined_metal += 		value.refined_metal
			this.heavy_armaments += 	value.heavy_armaments
			this.recreational_drugs += 	value.recreational_drugs
		}else if(typeof value === "number"){
			this.organics += 			value
			this.cultivable_soil += 	value
			this.water += 				value
			this.food += 				value
			this.basic_commodities += 	value
			this.luxury_goods += 		value
			this.raw_minerals += 		value
			this.metal_ore += 			value
			this.refined_metal += 		value
			this.heavy_armaments += 	value
			this.recreational_drugs += 	value
		}
	}

	multiply(value) {
		if(value instanceof Commodities){
			this.organics *= 			value.organics
			this.cultivable_soil *= 	value.cultivable_soil
			this.water *= 				value.water
			this.food *= 				value.food
			this.basic_commodities *= 	value.basic_commodities
			this.luxury_goods *= 		value.luxury_goods
			this.raw_minerals *= 		value.raw_minerals
			this.metal_ore *= 			value.metal_ore
			this.refined_metal *= 		value.refined_metal
			this.heavy_armaments *= 	value.heavy_armaments
			this.recreational_drugs *= 	value.recreational_drugs
		}else if(typeof value === "number"){
			this.organics *= 			value
			this.cultivable_soil *= 	value
			this.water *= 				value
			this.food *= 				value
			this.basic_commodities *= 	value
			this.luxury_goods *= 		value
			this.raw_minerals *= 		value
			this.metal_ore *= 			value
			this.refined_metal *= 		value
			this.heavy_armaments *= 	value
			this.recreational_drugs *= 	value
		}
	}

}




class Industry {
	constructor(base_productivity = 1, space_efficiency = 1, size = 0, requirements = new Commodities()){
		this.base_productivity =	base_productivity
		this.productivity =			base_productivity
		this.space_efficiency =		space_efficiency
		this.size =					size
		this.required_labor =		this.productivity * this.size
		this.requirements =			requirements
	}
}




function simplify(n){
    if(n < 1000){return Math.round(n)}
    let denom = 0
    const symbols = [" ", "K", "M", "B", "T", "Qa", "Qu", "Sx", "Se", "Oc", "No"]
    while(n >= 1000){
        denom++
        n *= 0.001
    }

    let nr = n
    nr = Math.floor(nr)
    nr = nr.toString()
    let len = nr.length
    nr = 3 - len
    if(nr > 0){
        n = n.toFixed(nr)
    }
    else {
        n = Math.floor(n)
    }

    return n + symbols[denom]
}




function update_resources_list(economy = new Economy()){
	const population = document.getElementById("population")
	population.textContent = Math.floor(Math.log10(economy.population))
	const organics = document.getElementById("organics")
	organics.textContent = simplify(economy.commodities.organics)
	const cultivable_soil = document.getElementById("cultivable-soil")
	cultivable_soil.textContent = simplify(economy.commodities.cultivable_soil)
	const water = document.getElementById("water")
	water.textContent = simplify(economy.commodities.water)
	const food = document.getElementById("food")
	food.textContent = simplify(economy.commodities.food)
	const basic_commodities = document.getElementById("basic-commodities")
	basic_commodities.textContent = simplify(economy.commodities.basic_commodities)
	const luxury_goods = document.getElementById("luxury-goods")
	luxury_goods.textContent = simplify(economy.commodities.luxury_goods)
	const raw_minerals = document.getElementById("raw-minerals")
	raw_minerals.textContent = simplify(economy.commodities.raw_minerals)
	const metal_ore = document.getElementById("metal-ore")
	metal_ore.textContent = simplify(economy.commodities.metal_ore)
	const refined_metal = document.getElementById("refined-metal")
	refined_metal.textContent = simplify(economy.commodities.refined_metal)
	const heavy_armaments = document.getElementById("heavy-armaments")
	heavy_armaments.textContent = simplify(economy.commodities.heavy_armaments)
	const recreational_drugs = document.getElementById("recreational-drugs")
	recreational_drugs.textContent = simplify(economy.commodities.recreational_drugs)
}




function water_industry_interpreter(water_industry = new Industry(), economy = new Economy()){
	console.log("water industry", water_industry, "\n economy", economy)
	
	const demand = economy.demand()
	water_industry.size = demand.water
	const jobs = Math.ceil(water_industry.size / water_industry.productivity)
}



const economy1 = new Economy(1000, 1200, 5000, 2000, 2500, 1000, 200, 0, 0, 0, 0, 500, 2)

console.log("economy 1", economy1)
console.log("demand", economy1.demand())

update_resources_list(economy1)

function advance_time(){

	update_resources_list(economy1)

	water_industry_interpreter(economy1.water_industry, economy1)

}




</script>
</html>